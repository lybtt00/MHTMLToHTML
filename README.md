# MHTML Conversion Tool

A powerful WPF desktop application for converting MHTML (.mht/.mhtml) files to HTML or Markdown format.

## 🌐 Language / 语言

- [English](README.md) (Current)
- [简体中文](README.zh-CN.md)

## 🌟 Features

- ✅ **Dual Format Output** - Supports both HTML and Markdown output formats
- ✅ **Modern Interface** - Beautiful WPF-based user interface
- ✅ **Drag & Drop** - Direct drag and drop MHTML files into the application
- ✅ **Batch Conversion** - Process multiple files simultaneously
- ✅ **Image Processing** - Convert images to Base64 encoding embedded in documents
- ✅ **Smart Encoding** - Auto-detect and handle multiple character encodings (GB2312, GBK, UTF-8, etc.)
- ✅ **Real-time Logging** - Display detailed conversion progress and log information
- ✅ **Keyboard Shortcuts** - Support Ctrl+O for quick file opening
- ✅ **Multi-language Support** - Complete Chinese/English bilingual interface with smart system language detection
- ✅ **Recent Files** - Automatically record and quickly access recently opened files
- ✅ **Language Switching** - Support runtime dynamic language switching

## 📋 System Requirements

- **Operating System**: Windows 10 or higher
- **Runtime**: .NET 8.0 Runtime
- **Memory**: 4GB or more recommended
- **Storage**: 50MB available space

## 🚀 Quick Start

### 1. Basic Usage

1. Run `MHTMLToHTML.exe`
2. Click "Browse..." button to select MHTML file, or drag and drop file directly into the input field
3. Choose output format (HTML or Markdown)
4. Set output path (automatically generated by the program)
5. Click "Start Conversion" button

### 2. Conversion Options

- **Include Images**: When checked, converts images to Base64 encoding embedded in document
- **Output Format**: 
  - HTML Format: Preserves original styles and layout
  - Markdown Format: Converts to clean Markdown document

### 3. Batch Conversion

- Select "Tools" > "Batch Conversion" from the menu bar
- Add multiple MHTML files for batch processing

## 🏗️ Technical Architecture

### Core Components

- **MHTMLParser**: MHTML file parsing engine
- **MainWindow**: Main interface interaction logic
- **BatchConvertWindow**: Batch conversion functionality
- **AboutWindow**: About information window
- **LanguageManager**: Multi-language management system
- **AppSettings**: Application settings management system

### Supported Encoding Formats

- Base64 encoding - Images and binary data
- Quoted-printable encoding - Multi-byte character processing
- 7bit/8bit encoding - Basic text encoding

### Supported Character Sets

- UTF-8 - Default recommended encoding
- GB2312/GBK/GB18030 - Simplified Chinese encoding
- Big5 - Traditional Chinese encoding
- ISO-8859-1 - Western European encoding
- Windows-1252 - Windows Western European encoding

## 📁 Project Structure

```
MHTMLToHTML/
├── MHTMLToHTML/
│   ├── MainWindow.xaml          # Main window interface
│   ├── MainWindow.xaml.cs       # Main window logic
│   ├── BatchConvertWindow.xaml  # Batch conversion interface
│   ├── BatchConvertWindow.xaml.cs # Batch conversion logic
│   ├── AboutWindow.xaml         # About window interface
│   ├── AboutWindow.xaml.cs      # About window logic
│   ├── MHTMLParser.cs          # MHTML parser core
│   ├── LanguageManager.cs      # Multi-language manager
│   ├── AppSettings.cs          # Application settings manager
│   ├── App.xaml                # Application definition
│   ├── App.xaml.cs             # Application logic
│   ├── app_icon.ico            # Application icon
│   ├── Properties/
│   │   ├── Resources.resx      # Chinese resource file
│   │   ├── Resources.en-US.resx # English resource file
│   │   └── AssemblyInfo.cs     # Assembly information
│   └── MHTMLToHTML.csproj      # Project file
├── Resources/
│   └── app_icon.png            # Icon resource
├── MHTMLToHTML.sln             # Solution file
└── README.md                   # Documentation
```

## 🔧 Dependencies

- **System.Text.Encoding.CodePages** (8.0.0) - Extended character set support
- **ReverseMarkdown** (2.0.0) - HTML to Markdown conversion

## 💻 Development Environment

### Build and Run

1. Ensure .NET 8.0 SDK is installed
2. Open terminal in project root directory
3. Execute the following commands:

```bash
# Restore NuGet packages
dotnet restore

# Build project
dotnet build

# Run project
dotnet run --project MHTMLToHTML
```

### Using Visual Studio

1. Open `MHTMLToHTML.sln` solution file
2. Visual Studio will automatically restore NuGet packages
3. Press F5 to run the project

## 📝 Usage Instructions

### Keyboard Shortcuts

- `Ctrl+O` - Open file
- `Alt+F4` - Exit program

### Menu Functions

- **File Menu**
  - Open MHTML file
  - Recent files list (displays up to 10 files)
  - Clear recent files list
  - Exit program
- **Tools Menu**
  - Batch conversion functionality
  - Options settings
  - Language settings (Auto detect/Simplified Chinese/English)
- **Help Menu**
  - Usage instructions (multi-language support)
  - About information (multi-language support)

### Supported File Formats

- **Input Format**: .mht, .mhtml
- **Output Format**: .html, .md

## 📊 Version History

### v1.1.0 (Multi-language Support Version)

- 🌍 **Multi-language Support** - Complete Chinese/English bilingual interface
  - Smart system language detection, defaults to English for non-Chinese systems
  - Manual language switching support (Auto/Simplified Chinese/English)
  - Complete UI element localization (menus, buttons, labels, messages, etc.)
  - Fully localized conversion process logs

- 📂 **Recent Files Feature** - Convenient file access experience
  - Automatically record recently opened MHTML files
  - File menu displays recent files list (up to 10 files)
  - Support quick opening of recently used files
  - Auto-cleanup of non-existent file records
  - Support clearing recent files list

- 🎨 **Interface Improvements**
  - Added default text content to MainWindow, solving font display issues
  - Optimized batch conversion window initialization logic
  - Fixed null reference exception issues

- 🔧 **Technical Optimizations**
  - New LanguageManager language management system
  - New AppSettings settings management system
  - Improved encoding detection and file reading mechanism
  - Enhanced error handling and user prompts

- 📖 **Resource Files**
  - Resources.resx (Chinese resources)
  - Resources.en-US.resx (English resources)
  - 70+ UI texts and log messages with multi-language support

### v1.0.0 (Initial Release)

- 🎉 First release
- 🔧 Basic MHTML to HTML conversion functionality
- 🎨 Modern WPF user interface
- 📁 Drag and drop support
- 🔀 Dual format output support (HTML/Markdown)
- 🖼️ Image processing and Base64 encoding support
- 📦 Batch conversion functionality
- 🌐 Multiple encoding format support
- 🐛 Comprehensive error handling and user prompts
- 📖 Chinese interface and help documentation

## 🐛 Known Issues

- Some complex MHTML files may require more parsing time
- Very large image files may result in larger output files
- Some special CSS styles may be lost during conversion

## 🗺️ Future Plans

- [ ] Support for more output formats (e.g., PDF)
- [ ] Add configuration file to save user settings
- [ ] Support command-line mode
- [ ] Add file preview functionality
- [ ] Optimize large file processing performance
- [ ] Add more conversion options

## 📄 License

This project is licensed under the MIT License. See the LICENSE file for details.

## 🤝 Contributing

Welcome to submit issue reports and feature requests! If you want to contribute to the project, please:

1. Fork this repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## 📞 Support

If you encounter problems or have any questions, please:

- Create an Issue to report problems
- Check the help documentation
- Contact the developer

---

**Thank you for using MHTML Conversion Tool!** 🎉

© 2024 MHTML Conversion Tool. All rights reserved. 
